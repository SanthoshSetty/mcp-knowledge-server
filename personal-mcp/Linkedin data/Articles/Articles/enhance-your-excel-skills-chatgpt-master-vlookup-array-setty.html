<html>
<head>
  <title>Enhance Your Excel Skills with ChatGPT: Master VLOOKUP, Array Formulas, Build Custom Functions, and Even Create a Tic Tac Toe Game</title>
  <style>
    body {
      margin: 0 auto;
      width: 744px;
      font-family: Source Serif Pro, serif;
      line-height: 32px;
      font-weight: 400;
      color: rgba(0, 0, 0, 0.7);
      font-size: 21px;
    }
    h1, h2, h3 {
      font-family: Source Sans Pro, Helvetica, Arial, sans-serif;
    }
    h1 a, h1 a:visited {
      color: inherit;
      text-decoration: none;
    }
    h1 {
      line-height: 48px;
      font-weight: 600;
      color: rgba(0, 0, 0, 0.85);
      font-size: 42px;
      margin: 32px 0 20px;
    }
    h2 {
      line-height: 32px;
      font-weight: 600;
      color: rgba(0, 0, 0, 0.85);
      font-size: 26px;
      margin: 28px 0;
    }
    h3 {
      line-height: 28px;
      font-weight: 600;
      color: rgba(0, 0, 0, 0.85);
      font-size: 21px;
      margin: 24px 0;
    }
    p {
      margin: 32px 0;
    }
    .created, .published {
      color: rgba(0, 0, 0, 0.55);
      font-size: 15px;
      line-height: 15px;
      margin: 20px 0;
    }
    .created + .published {
      margin-top: -12px;
    }
    blockquote {
      font-family: Georgia, Source Serif Pro, serif;
      font-style: italic;
      font-size: 24px;
      line-height: 36px;
      margin: 48px 120px;
      text-align: center;
    }
    a {
      word-wrap: break-word;
      outline: none;
      text-decoration: none;
      background-color: transparent;
      border: 0;
      color: #008CC9;
    }
    a:hover {
      text-decoration: underline;
    }
    a:visited {
      color: #8C68CB;
    }
    .center {
      text-align: center;
    }
    iframe {
      display: block;
      margin: 44px auto;
    }
    *:not(pre) + pre, pre:first-of-type {
      margin-top: 32px;
      padding-top: 32px;
    }
    pre:only-of-type {
      margin: 32px 0;
      padding: 32px;
    }
    pre {
      background: #F3F6F8;
      overflow-x: auto;
      display: block;
      font-size: 13px;
      font-family: monospace;
      line-height: 13px;
      padding: 0 32px 32px;
      white-space: pre;
    }
    a.embedded {
      background: #F3F6F8;
      display: block;
      padding: 32px;
      margin: 32px 0;
    }
    img {
      height: auto;
      max-width: 100%;
    }
    .slate-image-embed__resize-full-width img {
      width: 100%;
    }
    .series-logo {
      width: 48px;
      height: 48px;
      box-sizing: border-box;
      background-clip: content-box;
      border: 4px solid transparent;
      border-radius: 6px;
      object-fit: scale-down;
      float: left;
    }
    .series-title {
      font-size: 16px;
      font-weight: 600;
      vertical-align: top;
    }
    .series-description {
      color: rgba(0,0,0,.6);
      font-weight: 400;
      font-size: 14px;
      line-height: 20px;
    }
    div {
      margin: 32px 0;
    }
  </style>
</head>
<body>
    <img class="series-logo" src="https://media.licdn.com/dms/image/v2/D4E12AQEqrG3yf687xg/series-logo_image-shrink_300_300/series-logo_image-shrink_300_300/0/1687008164072?e=1755734400&v=beta&t=_bAF5fqYM3fmXm02gQGDI9XnhC1lR7PLw5ic4nJyLe8" />
    <h3>
      <span class="series-title">WorkWonders with AI</span>
      </br>
      <span class="series-description">Boost office productivity with 'WorkWonders with AI', exploring AI tools like ChatGPT and Bard solving real problems</span>
    </h3>
    <img src="https://media.licdn.com/mediaD4E12AQGkVr96RTP_cQ" alt="" title="" />
      <h1><a href="https://www.linkedin.com/pulse/enhance-your-excel-skills-chatgpt-master-vlookup-array-setty">Enhance Your Excel Skills with ChatGPT: Master VLOOKUP, Array Formulas, Build Custom Functions, and Even Create a Tic Tac Toe Game</a></h1>
    <p class="created">Created on 2023-06-27 16:11</p>
  <p class="published">Published on 2023-06-28 04:30</p>
  <div><p>Get ready to supercharge your workday with Excel and ChatGPT! Imagine effortlessly locating data with VLOOKUP, handling complex calculations with sophisticated Array Formulas, and crafting your own Custom Functions tailored to your unique needs. And here’s a twist: How about indulging in a playful break with a game of Tic Tac Toe right inside Excel?&nbsp;</p><p>This isn't a dream. It's your usual Excel, transformed into an exciting, dynamic, and enjoyable work hub with the combined prowess of Excel and ChatGPT. Stay tuned as we unveil each step of this transformation, ensuring you not only achieve optimal productivity, but also discover the fun in Excel. Your workday is about to get a major upgrade, so let’s get started!</p><h3>1. VLOOKUP - Simple and Complex</h3><p>One of the most powerful features of Excel is the VLOOKUP function. This function allows you to retrieve specific data associated with a value in your spreadsheet. To demonstrate this, I will use the following dataset as in the screenshot (Fig 1). </p><figure class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img alt="No alt text provided for this image" data-media-urn="urn:li:digitalmediaAsset:D4E12AQHdZ-QrZJZP8Q" src="https://media.licdn.com/dms/image/v2/D4E12AQHdZ-QrZJZP8Q/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1687899499750?e=1755734400&amp;v=beta&amp;t=a2b_h3lkBPeefRdCwglGrezbvr-sGQEEWzDSsvOc7kA"><figcaption>Fig 1 - A1 to D9 - Dataset || F1 to G4 - retrieve Dept based on ID || F6 to G9 - retrieve average salary based on Dept</figcaption></figure><p>For example, suppose you have an employee database, and you want to quickly retrieve an employee's department using their ID. You can use a simple VLOOKUP function.</p><p>I have employee IDs in the column A, Dept in column B ,Name of the employee in column C and Salary of the employee in Column D . Now I have to retrieve Dept based on ID, we usually use Vlookup to match ID with dept and get the actual Dept. Eventhough it is simple, lets ask chatGPT.&nbsp;</p><figure class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img alt="No alt text provided for this image" data-media-urn="urn:li:digitalmediaAsset:D4D12AQFZD6HmDbs7YQ" src="https://media.licdn.com/dms/image/v2/D4D12AQFZD6HmDbs7YQ/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1687900015390?e=1755734400&amp;v=beta&amp;t=mY1vfc5VpGd35QQdsM5jBOV8kia9kFvbxpIwJ1hibWM"><figcaption>Fig 2 - ChatGPT Prompt and response retrieve Dept based on ID</figcaption></figure><p>For a very simple case, ChatGPT succeded. However, If I were to write the function, I would have written as <strong>"=VLOOKUP(F2, $A$1:$D$9, 2, FALSE)" , </strong>instead of <strong>"=VLOOKUP(F2, A1:D9, 2, FALSE)"</strong></p><p>Let's add a twist to it - suppose you want to return <strong>'Not Found'</strong> if the ID doesn't exist in the database and you want to retrieve data only if the employee is from the <strong>Sales department</strong>. This requires a complex VLOOKUP combined with IF and IFERROR commands. Lets see if chatGPT can provide a proper formula.  </p><figure class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img alt="No alt text provided for this image" data-media-urn="urn:li:digitalmediaAsset:D4D12AQF0kQDT3O3iBA" src="https://media.licdn.com/dms/image/v2/D4D12AQF0kQDT3O3iBA/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1687900372648?e=1755734400&amp;v=beta&amp;t=ugkqbzDtL3Q9RTDhWn_3iLGph0i4sxalGYCNzL9qs_A"><figcaption>Fig 2 - ChatGPT Prompt and response for "return not found if ID doesn't exist" and retrieve data only if the employee is from the Sales department</figcaption></figure><p>ChatGPT gave the formula as <strong>"=IFERROR(IF(VLOOKUP(F2, A1:D9, 2, FALSE)="Sales", VLOOKUP(F2, A1:D9, 2, FALSE), "Not Found"), "Not Found")"</strong>. Just from the looks of it, we can say that ChatGPT has considered all the use cases and returned a proper output. However, if I were writing the formula, I would have used <strong>$A$1:$D$9</strong> instead of <strong>A1:D9</strong>. Its just a best practice. Nevertheless, I am satisfied with ChatGPT's response so far. </p><p>Let's move on to creating Array formulas with ChatGPT</p><h3>2. Array Formulas</h3><p>An array formula is a formula that can perform multiple calculations on one or more items in an array. Array formulas can return either multiple results or a single result.</p><p>I am going to use the same Dataset (as in Fig 1) for demonstrating array formulas.  For instance, you could use an array formula to find the average salary of employees in the "Sales" department. There are other ways to calculate average without using array formula, but I am going to ask chatGPT to use Array formula to demonstrate the ability of chatGPT to give proper instructions&nbsp;.</p><p><br></p><figure class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img alt="No alt text provided for this image" data-media-urn="urn:li:digitalmediaAsset:D4D12AQGY05PYvbqnjA" src="https://media.licdn.com/dms/image/v2/D4D12AQGY05PYvbqnjA/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1687900899092?e=1755734400&amp;v=beta&amp;t=1Lo8YtgRcBqxxzN1g1201xk0iG1UfgIbX40lnxsb4K0"><figcaption>Fig 3 - ChatGPT Prompt and response for "return average salary by department"</figcaption></figure><p><br></p><p>I am a bit impressed on clear instructions by ChatGPT in this case. For eg, ChatGPT is instructing to press<strong> Ctrl + Shift + Enter</strong> to make Excel recognize that its an array formula. I tried all the above formulas in my excel sheet and it worked. </p><p>Now that we have played with some formulas in Excel,lets go a bit deeper into <strong>Experts only area</strong> where we create our own formula using excel. We will have to use <strong>VBA for creating our own formula</strong> and we can ask chatGPT for the help</p><h3>3. Creating a custom formula - using VBA</h3><p>Lets say you are from payroll department and your employees keep asking the same question every month on <strong>"how much income I would get after taxes?". I</strong>nstead of providing a complex formula or a flowchart to calculate, you can give them an excel sheet with a custom made formula and let them calculate on their own. Let's explore this use case now</p><p>First, lets define the rules to ask chatGPT,&nbsp;as creating a VBA program would require specific instructions in prompt. For demo I am using a basic German after tax income usecase as an example. ChatGPT prompt that I gave is as follows</p><figure class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img alt="No alt text provided for this image" data-media-urn="urn:li:digitalmediaAsset:D4D12AQEB9g9-9J8I4w" src="https://media.licdn.com/dms/image/v2/D4D12AQEB9g9-9J8I4w/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1687901492932?e=1755734400&amp;v=beta&amp;t=C83f4UvmwGOdL-bTUEJX-ItTydlyeZbwnQIX4Dh_dkc"><figcaption>Fig 4 - ChatGPT prompt to generate VBA code for creating a custom "After tax Income formula".</figcaption></figure><p><br></p><p>The response I got from chatGPT was as follows&nbsp;</p><p><em>Certainly! Here are step-by-step instructions on how to create and use the VBA function:</em></p><p><strong><em>Step 1: </em></strong><em>Open the Visual Basic for Applications (VBA) editor in your Microsoft Office application (e.g., Excel, Word, or Access). You can usually access the VBA editor by pressing Alt+F11 or going to the Developer tab and clicking on Visual Basic.</em></p><p><strong><em>Step 2:</em></strong><em> In the VBA editor, insert a new module by clicking on "Insert" in the menu bar and selecting "Module." This will create a new module where you can write your VBA code.</em></p><p><strong><em>Step 3: </em></strong><em>In the new module, copy and paste the following code:</em></p><pre spellcheck="false">Function AfterTaxIncome(GrossIncome As Double, TaxClass As Integer, IsChurchMember As Boolean, State As String) As Double
&nbsp; &nbsp; Dim IncomeTax As Double
&nbsp; &nbsp; Dim ChurchTax As Double


&nbsp; &nbsp; ' Calculate income tax based on tax class
&nbsp; &nbsp; If TaxClass = 1 Or TaxClass = 2 Then
&nbsp; &nbsp; &nbsp; &nbsp; ' Tax calculation for class I (simplified, update with current rules)
&nbsp; &nbsp; &nbsp; &nbsp; If GrossIncome &lt;= 9408 Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IncomeTax = 0
&nbsp; &nbsp; &nbsp; &nbsp; ElseIf GrossIncome &lt;= 14753 Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IncomeTax = (995.21 * ((GrossIncome - 9408) / 10000) ^ 2 + 1400) * ((GrossIncome - 9408) / 10000)
&nbsp; &nbsp; &nbsp; &nbsp; ElseIf GrossIncome &lt;= 57051 Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IncomeTax = (208.85 * ((GrossIncome - 14753) / 10000) ^ 2 + 2397) * ((GrossIncome - 14753) / 10000) + 950.96
&nbsp; &nbsp; &nbsp; &nbsp; ElseIf GrossIncome &lt;= 270500 Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IncomeTax = 0.42 * GrossIncome - 8963.74
&nbsp; &nbsp; &nbsp; &nbsp; Else
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IncomeTax = 0.45 * GrossIncome - 17078.74
&nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; End If


&nbsp; &nbsp; ' Calculate church tax if the person is a church member
&nbsp; &nbsp; If IsChurchMember Then
&nbsp; &nbsp; &nbsp; &nbsp; If State = "Bavaria" Or State = "Baden-Württemberg" Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ChurchTax = 0.08 * IncomeTax
&nbsp; &nbsp; &nbsp; &nbsp; Else
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ChurchTax = 0.09 * IncomeTax
&nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; Else
&nbsp; &nbsp; &nbsp; &nbsp; ChurchTax = 0
&nbsp; &nbsp; End If


&nbsp; &nbsp; ' Subtract taxes from gross income
&nbsp; &nbsp; AfterTaxIncome = GrossIncome - IncomeTax - ChurchTax
End Function
</pre><p><strong><em>Step 4:</em></strong><em> Save the module by clicking on "File" in the menu bar and selecting "Save [module_name]".</em></p><p><strong>Step 5:</strong> Now you can use the AfterTaxIncome<em> function in your worksheet </em></p><p>I followed the step by step instructions from chatGPT and created the VBA function and now I can use the custom formula in my Excel. Refer to the below screenshot for the output.</p><figure class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img alt="No alt text provided for this image" data-media-urn="urn:li:digitalmediaAsset:D4D12AQHSAabxsEWMPw" src="https://media.licdn.com/dms/image/v2/D4D12AQHSAabxsEWMPw/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1687901959048?e=1755734400&amp;v=beta&amp;t=PlFn7aw23XCXLzjFYyMhkyCxMldQAAY48IRV15gntYc"><figcaption>Fig 5 - Custom formula to calculate After Tax Income</figcaption></figure><p>Now the syntax is "=AfterTaxIncome (<strong>GrossIncome</strong>, <strong>TaxClass</strong>, <strong>IsChurchMember</strong>, <strong>State</strong>)" and it worked for me as shown in the above screenshot.  Pretty cool isn't it? </p><h3>4. Fun with Excel - Creating a TicTacToe Game in VBA</h3><p>Enough about work, <strong>let's have some fun with Excel!</strong> Did you know you can create simple games in Excel? Yes, you heard it right! For instance, you can create a <strong>Tic Tac Toe</strong> game in Excel. With a bit of VBA and guidance from ChatGPT, you can create a game that you can play right within Excel. This is just one example. If you can imagine it, you can create it in Excel with the help of ChatGPT.</p><p>I would want to look my TicTacToe game to look like below screenshot in Excel, so that I can access through my spread sheet. </p><figure class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img alt="No alt text provided for this image" data-media-urn="urn:li:digitalmediaAsset:D4D12AQEqfV9h1-ttYQ" src="https://media.licdn.com/dms/image/v2/D4D12AQEqfV9h1-ttYQ/article-inline_image-shrink_400_744/article-inline_image-shrink_400_744/0/1687902359367?e=1755734400&amp;v=beta&amp;t=sAQfg2ONnpvjyJDfplpFJzV1TnZQ7yQ1fWOjKQsZQJE"><figcaption>Fig 6 - TicTacToe representation in Excel.</figcaption></figure><p><br></p><p>Now to make a game like this I need to give very specific instructions to ChatGPT. Following is the prompt I gave to ChatGPT. </p><figure class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img alt="No alt text provided for this image" data-media-urn="urn:li:digitalmediaAsset:D4D12AQHoH85rlElFCA" src="https://media.licdn.com/dms/image/v2/D4D12AQHoH85rlElFCA/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1687902786775?e=1755734400&amp;v=beta&amp;t=D_KNsa8er8dshbxuQ7B_49QytSERtRrpZ_dP6KlgUJo"><figcaption>Fig 7 - ChatGPT Prompt to generate code for TicTacToe game</figcaption></figure><p>Following is the response from ChatGPT </p><p><strong><em>Step 1:</em></strong></p><ol><li><em>Open the Visual Basic Editor in Excel by pressing Alt + F11.</em></li><li><em>Insert a new module by clicking on "Insert" in the menu and selecting "Module."</em></li><li><em>Copy and paste the following code into the newly created module</em></li></ol><pre spellcheck="false">Public playerTurn As Boolean ' True if it's the player's turn, False if it's the computer's


Sub StartGame()
&nbsp; &nbsp; Dim rng As Range
&nbsp; &nbsp; For Each rng In ThisWorkbook.Sheets("TicTacToe").Range("A1:C3") ' Clear the board
&nbsp; &nbsp; &nbsp; &nbsp; rng.Value = ""
&nbsp; &nbsp; Next rng
&nbsp; &nbsp; playerTurn = True ' The player always starts
End Sub


Sub ComputerPlay()
&nbsp; &nbsp; Dim rng As Range
&nbsp; &nbsp; Dim center As Range
&nbsp; &nbsp; Dim corners As New Collection
&nbsp; &nbsp; Dim emptyCells As New Collection


&nbsp; &nbsp; If CheckWin("X") Then
&nbsp; &nbsp; &nbsp; &nbsp; MsgBox "You win!", vbInformation
&nbsp; &nbsp; &nbsp; &nbsp; StartGame
&nbsp; &nbsp; &nbsp; &nbsp; Exit Sub
&nbsp; &nbsp; End If


&nbsp; &nbsp; With ThisWorkbook.Sheets("TicTacToe")
&nbsp; &nbsp; &nbsp; &nbsp; For Each rng In .Range("A1:C3") ' Find all empty cells
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If rng.Value = "" Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; emptyCells.Add rng
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Select Case rng.Address
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case "$B$2"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set center = rng
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case "$A$1", "$A$3", "$C$1", "$C$3"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corners.Add rng
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Select
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; &nbsp; &nbsp; Next rng


&nbsp; &nbsp; &nbsp; &nbsp; If Not playerTurn Then ' If it's the computer's turn
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '1. Win if possible
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For Each rng In emptyCells
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rng.Value = "O"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CheckWin("O") Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MsgBox "Computer won!", vbInformation
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; StartGame
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Sub
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rng.Value = ""
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next rng
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '2. Block player from winning
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For Each rng In emptyCells
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rng.Value = "X"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CheckWin("X") Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rng.Value = "O"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTurn = True ' Switch turns
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Sub
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rng.Value = ""
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next rng
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '3. Take the center if it's available
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Not center Is Nothing Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; center.Value = "O"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '4. Take a corner if it's available
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf corners.Count &gt; 0 Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; corners(CInt((corners.Count - 1) * Rnd + 1)).Value = "O"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '5. Take any other cell
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf emptyCells.Count &gt; 0 Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; emptyCells(CInt((emptyCells.Count - 1) * Rnd + 1)).Value = "O"
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If


&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTurn = True ' Switch turns


&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ' Check for a draw
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Application.WorksheetFunction.CountBlank(ThisWorkbook.Sheets("TicTacToe").Range("A1:C3")) = 0 Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MsgBox "It's a draw!", vbInformation
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; StartGame
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Sub
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; End With
End Sub


Function CheckWin(s As String) As Boolean
&nbsp; &nbsp; Dim i As Integer
&nbsp; &nbsp; Dim winCombinations As Variant


&nbsp; &nbsp; ' Define win combinations
&nbsp; &nbsp; winCombinations = Array(Array("A1", "B1", "C1"), _
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Array("A2", "B2", "C2"), _
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Array("A3", "B3", "C3"), _
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Array("A1", "A2", "A3"), _
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Array("B1", "B2", "B3"), _
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Array("C1", "C2", "C3"), _
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Array("A1", "B2", "C3"), _
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Array("A3", "B2", "C1"))


&nbsp; &nbsp; With ThisWorkbook.Sheets("TicTacToe")
&nbsp; &nbsp; &nbsp; &nbsp; For i = 0 To 7 ' Check all win combinations
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If .Range(winCombinations(i)(0)).Value = s And _
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.Range(winCombinations(i)(1)).Value = s And _
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.Range(winCombinations(i)(2)).Value = s Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CheckWin = True
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; &nbsp; &nbsp; Next i
&nbsp; &nbsp; End With
End Function


</pre><p><strong><em>Step 2:</em></strong></p><ol><li><em>Close the module window.</em></li><li><em>Right-click on the sheet named "TicTacToe" in the Excel workbook.</em></li><li><em>Select "View Code."</em></li><li><em>Copy and paste the following code into the code window</em></li></ol><pre spellcheck="false">Private Sub Worksheet_SelectionChange(ByVal Target As Range
&nbsp; &nbsp; If Not Intersect(Target, Me.Range("A1:C3")) Is Nothing And Target.Cells.Count = 1 Then ' If a cell within A1:C3 is selected...
&nbsp; &nbsp; &nbsp; &nbsp; If Target.Value = "" And playerTurn Then ' ...and it's empty, and it's the player's turn
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Target.Value = "X" ' The player is always X
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CheckWin("X") Then
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MsgBox "You win!", vbInformation
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Sub
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playerTurn = False ' Switch turns
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Application.OnTime Now, "ComputerPlay" ' Queue up the computer's turn
&nbsp; &nbsp; &nbsp; &nbsp; End If
&nbsp; &nbsp; End If
End Sub

)
</pre><p><strong><em>Step 3:</em></strong></p><ol><li><em>Close the Visual Basic Editor.</em></li><li><em>Insert a button into your worksheet (e.g., on the "TicTacToe" sheet).</em></li><li><em>Right-click on the button and select "Assign Macro."</em></li><li><em>Choose the "StartGame" macro from the list and click "OK."</em></li></ol><p>That's it! You have successfully built the Tic-Tac-Toe game in VBA. The "StartGame" macro is now connected to the "Play" button, and the game logic is implemented in the VBA code.</p><p>Now, I followed the instructions and I created a fully functioning game in Excel. Refer to the following screenshot. I played dumb to see if computer can pickup and it did win. </p><figure class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img alt="No alt text provided for this image" data-media-urn="urn:li:digitalmediaAsset:D4D12AQFoTROdt36J3Q" src="https://media.licdn.com/dms/image/v2/D4D12AQFoTROdt36J3Q/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1687903260594?e=1755734400&amp;v=beta&amp;t=DuzeN676T-UKHQiyTIxSihR1D5kJgk7qYSUySqq0XS8"><figcaption>Fig 8 - Final Product in Excel - TicTacToe game</figcaption></figure><p><br></p><p>Thank you for taking the time to read this article. I hope you found it helpful and informative. Remember, Excel is a powerful tool, and with the help of ChatGPT, you can master it! As you continue to explore the functionalities of Excel and leverage the capabilities of ChatGPT, you'll find that your productivity soars, your data becomes more manageable, and your workdays become a little more fun. Happy Excelling!</p><p><br></p><p><br></p></div>
</body>
</html>